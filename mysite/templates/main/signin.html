{% extends 'base.html' %}
{% load static %}
{% block content %}
{% load socialaccount %}
<!-- signin start -->

<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wondoodoo 로그인</title>
    <link rel="stylesheet" href="{% static 'css/reset.css' %}">
    <link rel="stylesheet" href="{% static 'css/modules_login.css' %}">
    <link rel="stylesheet" href="{% static 'css/login.css' %}">
</head>

<body>
    <article class="modal-login on">
        <h2 class="txt-hide">회원가입, 로그인 또는 소셜서비스로 로그인</h2>
        <section class="cont-form-login">
            <h3 class="tit-form">Wondoodoo</h3>
            <form class="form-login" method="post" action="{% url 'users:signin' %}">
                {% csrf_token %}
                <fieldset class="module-inp module-inp-id error">
                    <br>
                    <br>
                    <label for="inpId" class="txt-hide">아이디</label>
                    <input type="text" class="inp-login" id="inpId" name="username" placeholder="아이디">
                    <strong class="inp-error">아이디를 입력해주세요.</strong>
                </fieldset>
                <fieldset class="module-inp error">
                    <input type="password" id="inpPw" class="inp-login" name="password" placeholder="비밀번호">
                    <label for="inpPw" class="txt-hide">비밀번호</label>
                    <strong class="inp-error">아이디 혹은 비밀번호와 일치하지 않습니다.</strong>
                </fieldset>
                <input type="checkbox" id="inpHold" class="inp-hold txt-hide">
                <label for="inpHold" class="labl-hold">로그인 상태 유지</label>
                <button type="submit" class="btn-login">로그인</button>
                <div class="link-userinfo">
                    <a href="{% url 'users:signup' %}" class="link-signup">회원가입</a>
                    <a href="javascript:void(0);" class="link-lost">아이디/비밀번호 찾기</a>
                </div>
            </form>
            <section class="cont-sns-login">
                <h3 class="txt-hide">소셜서비스로 로그인</h3>
                <ul>
                    <li><a href="javascript:void(0);" class="naver-login-button">네이버 계정으로 로그인</a></li>
                    <li><a href="javascript:void(0);" class="icon-kakao link-sns-login">카카오 계정으로 로그인</a></li>
                </ul>
            </section>
            <button type="button" class="btn-close"><img src="{% static 'images_login/close.png' %}" alt="로그인 닫기"></button>
        </section>
    </article>
    <script>
        const targetModal = document.querySelector(".modal-login");
        document.querySelector('#appLogin .btn-login').addEventListener('click', (e) => {
            toggleModal()
        });
        document.querySelector('.modal-login .btn-close').addEventListener('click', (e) => {
            toggleModal()
        });
        function toggleModal() {
            targetModal.classList.toggle('on');
        }
    </script>
<!-- HTML 템플릿 파일 -->
<li><a href="javascript:void(0);" class="naver-login-button">네이버 계정으로 로그인</a></li>

<!-- JavaScript 코드 -->
<script>
    document.querySelector('.naver-login-button').addEventListener('click', function(e) {
    e.preventDefault(); // 기본 이벤트 방지 (링크 이동 방지)

    // 네이버 소셜 로그인 팝업 열기
    const naverLoginPopup = window.open('{{ naver_login_url }}', '네이버 로그인', 'width=600, height=400');

    // 팝업이 닫힐 때 이벤트 처리
    window.addEventListener('message', function(event) {
        if (event.origin !== '{{ naver_login_url }}') {
            return;
        }

        // 팝업에서 받아온 정보 처리
        const data = event.data;
        if (data.type === 'naver-login-success') {
            // 네이버 로그인 성공 시 처리할 로직을 여기에 작성
            // data.email과 data.name을 서버로 전송하거나 필요한 동작 수행
            console.log('네이버 로그인 성공 - 이메일: ' + data.email + ', 이름: ' + data.name);
        } else if (data.type === 'naver-login-failure') {
            // 네이버 로그인 실패 시 처리할 로직을 여기에 작성
            console.log('네이버 로그인 실패');
        }

        // 팝업 닫기
        naverLoginPopup.close();
    });
});
</script>

{% endblock %}
</body>

</html>


